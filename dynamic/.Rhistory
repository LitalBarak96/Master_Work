}
if(length_of_movie == 27000){
name_of_interactionmat_len<-"interactionMatrix_frame_0_to_27000_gap_120_interaction_length.txt"
name_of_interactionmat_num<-"interactionMatrix_frame_0_to_27000_gap_120_interaction_number.txt"
}
if(with_Angelsub == TRUE){
name_of_mat<-"AllinteractionWithAngelsub.mat"
}else{
name_of_mat<-"Allinteraction.mat"
}
dir<-list.dirs(recursive = F,path = "D:/allGroups/Males_Mated")
all_movie_change<-NULL
for(num_of_movie in 1:8){
filepath<-paste0(dir[num_of_movie], '/',name_of_mat)
if(!(file.exists(filepath))){
stop("Allinteraction.mat does not exist!!!please creat it with MainInteractionAllAngelSub.m ")
}
mat <- (readMat(paste0(dir[num_of_movie], '/',name_of_mat)))
number_of_flys<-sqrt(length(mat[["new.interactionFrameMatrix"]]))
# read each MAT file
sub_list_mat<-matrix(mat[["new.interactionFrameMatrix"]],nrow = number_of_flys, ncol = number_of_flys)
df_mat<-as.data.frame(sub_list_mat)
for(i in 1:ncol(df_mat)){
for(j in 1:nrow(df_mat)){
if(length(unlist(df_mat[i,j])) == 0){
df_mat[i,j] <- lapply(df_mat[i,j], function(x)x[lengths(x) == 0] <- 0)
}
}
}
df_mat<-na.omit(df_mat)
#10 flys
colnames(df_mat)<-c(1:number_of_flys)
rownames(df_mat)<-c(1:number_of_flys)
all<-data.frame()
path_to_sub_Scripts<-"C:/Users/barakli8/OneDrive - Bar Ilan University/Lital/code/interactions_network/dynamic/sub_scripts"
setwd(path_to_sub_Scripts)
files.sources = list.files()
sapply(files.sources, source)
all<-all_frames_interaction_above(number_of_flys,sub_list_mat,df_mat)
#for the acasct every interaction mean 1
all<-cbind(all,1)
library(dplyr)
library(igraph)
all_changes_current_movie<-NULL
for(i in 1:(length(numbers)-1)){
current_net<-creat_network(all,i,numbers)
sub_current_net<-biggest_cc_subgraph(current_net)
if(sub_current_net[[2]] == FALSE){
# no sub cluster bigger than 3
sub_current_net<-(sub_current_net[[1]])
size_of_biggest_cc_current = 0
}else{
sub_current_net<-(sub_current_net[[1]])
size_of_biggest_cc_current= length(sub_current_net)
}
#bigeest cc show the cc if it is bigger than 3,else it is 0
tmp<-data.frame(number_of_movie=num_of_movie,frame = i,size_cc = size_of_biggest_cc_current)
all_changes_current_movie<-rbind(all_changes_current_movie,tmp)
print(i)
}
print(num_of_movie)
all_movie_change<-rbind(all_movie_change,all_changes_current_movie)
}
all_movie_change$number_of_movie<-as.factor(all_movie_change$number_of_movie)
library(ggplot2)
all_movies<-ggplot(all_movie_change, aes(frame,size_cc,colour = number_of_movie)) +
geom_point() +
geom_line() +
facet_wrap(~number_of_movie,nrow =2)
midean_all_movies<-ggplot(all_movie_change, aes(frame,size_cc,colour = number_of_movie)) +
geom_point() +
geom_line() + stat_summary(fun = "median", geom = "line", color = "black", size = 1.1)
plot(all_movies)
plot(midean_all_movies)
plot(all_movies)
plot(midean_all_movies)
library(openxlsx)
library(stringr)
library(dplyr)
library(reshape2)
library(igraph)
library(R.matlab)
f <- function(x) {
if(is.list(x)) lapply(x, f)
else ifelse(length(x) == 0, 0, x)
}
length_of_movie<-27000
#how many frame in a batch
number_of_frame<-1
#seq by the  number of frames
numbers<-seq(1, length_of_movie, by=number_of_frame)
with_Angelsub<-TRUE
#if i want without angelsub for calcualtin of interaction choose Allinteraction.mat
#if you do want it choose AllinteractionWithAngelsub.mat
if(length_of_movie == 54000){
name_of_interactionmat_len<-"interactionMatrix_frame_0_to_54000_gap_120_interaction_length.txt"
name_of_interactionmat_num<-"interactionMatrix_frame_0_to_54000_gap_120_interaction_number.txt"
}
if(length_of_movie == 27000){
name_of_interactionmat_len<-"interactionMatrix_frame_0_to_27000_gap_120_interaction_length.txt"
name_of_interactionmat_num<-"interactionMatrix_frame_0_to_27000_gap_120_interaction_number.txt"
}
if(with_Angelsub == TRUE){
name_of_mat<-"AllinteractionWithAngelsub.mat"
}else{
name_of_mat<-"Allinteraction.mat"
}
dir<-list.dirs(recursive = F,path = "D:/allGroups/Males_Mated")
num_of_movie=1
filepath<-paste0(dir[num_of_movie], '/',name_of_mat)
if(!(file.exists(filepath))){
stop("Allinteraction.mat does not exist!!!please creat it with MainInteractionAllAngelSub.m ")
}
mat <- (readMat(paste0(dir[num_of_movie], '/',name_of_mat)))
number_of_flys<-sqrt(length(mat[["new.interactionFrameMatrix"]]))
# read each MAT file
sub_list_mat<-matrix(mat[["new.interactionFrameMatrix"]],nrow = number_of_flys, ncol = number_of_flys)
df_mat<-as.data.frame(sub_list_mat)
for(i in 1:ncol(df_mat)){
for(j in 1:nrow(df_mat)){
if(length(unlist(df_mat[i,j])) == 0){
df_mat[i,j] <- lapply(df_mat[i,j], function(x)x[lengths(x) == 0] <- 0)
}
}
}
df_mat<-na.omit(df_mat)
#10 flys
colnames(df_mat)<-c(1:number_of_flys)
rownames(df_mat)<-c(1:number_of_flys)
all<-data.frame()
path_to_sub_Scripts<-"C:/Users/barakli8/OneDrive - Bar Ilan University/Lital/code/interactions_network/dynamic/sub_scripts"
setwd(path_to_sub_Scripts)
files.sources = list.files()
sapply(files.sources, source)
all<-all_frames_interaction_above(number_of_flys,sub_list_mat,df_mat)
#for the acasct every interaction mean 1
all<-cbind(all,1)
library(dplyr)
library(igraph)
all_changes_current_movie<-NULL
for(i in 1:(length(numbers)-1)){
current_net<-creat_network(all,i,numbers)
sub_current_net<-biggest_cc_subgraph(current_net)
if(sub_current_net[[2]] == FALSE){
# no sub cluster bigger than 3
sub_current_net<-(sub_current_net[[1]])
size_of_biggest_cc_current = 0
}else{
sub_current_net<-(sub_current_net[[1]])
size_of_biggest_cc_current= length(sub_current_net)
}
#bigeest cc show the cc if it is bigger than 3,else it is 0
tmp<-data.frame(frame = i,size_cc = size_of_biggest_cc_current)
all_changes_current_movie<-rbind(all_changes_current_movie,tmp)
print(i)
}
View(all_changes_current_movie)
test <- sample(1:50)
test
test
library(zoo)
View(all_changes_current_movie)
test<-all_changes_current_movie$size_cc
test
rollapply(test, 100, toString, align = "left", fill = NA)
ttest<-rollapply(test, 100, toString, align = "left", fill = NA)
ttest
library(zoo)
test<-all_changes_current_movie$size_cc
library(zoo)
means <- sapply(c("left"),
function(x)zoo::rollmean(test,100,align = x, na.pad = TRUE))
cbind(test,means)
library(zoo)
test<-all_changes_current_movie$size_cc
library(zoo)
means <- sapply(c("left"),
function(x)zoo::rollmean(test,100,align = x, na.pad = TRUE))
ttest<-cbind(test,means)
View(ttest)
library(zoo)
test<-all_changes_current_movie$size_cc
library(zoo)
means <- sapply(c("right","center","left"),
function(x)zoo::rollmean(test,100,align = x, na.pad = TRUE))
ttest<-cbind(test,means)
View(ttest)
View(ttest)
View(ttest)
ttest %>% mutate(mycol = coalesce(right,center,left)) %>%
select(test, mycol)
ttest<-as.data.frame(ttest)
#combind the colom of each rollmean to remove na
ttest %>% mutate(mycol = coalesce(right,center,left)) %>%
select(test, mycol)
View(ttest)
no_na<-ttest %>% mutate(mycol = coalesce(right,center,left)) %>%
select(test, mycol)
View(no_na)
View(no_na)
library(openxlsx)
library(stringr)
library(dplyr)
library(reshape2)
library(igraph)
library(R.matlab)
f <- function(x) {
if(is.list(x)) lapply(x, f)
else ifelse(length(x) == 0, 0, x)
}
length_of_movie<-27000
#how many frame in a batch
number_of_frame<-1
#seq by the  number of frames
numbers<-seq(1, length_of_movie, by=number_of_frame)
with_Angelsub<-TRUE
#if i want without angelsub for calcualtin of interaction choose Allinteraction.mat
#if you do want it choose AllinteractionWithAngelsub.mat
if(length_of_movie == 54000){
name_of_interactionmat_len<-"interactionMatrix_frame_0_to_54000_gap_120_interaction_length.txt"
name_of_interactionmat_num<-"interactionMatrix_frame_0_to_54000_gap_120_interaction_number.txt"
}
if(length_of_movie == 27000){
name_of_interactionmat_len<-"interactionMatrix_frame_0_to_27000_gap_120_interaction_length.txt"
name_of_interactionmat_num<-"interactionMatrix_frame_0_to_27000_gap_120_interaction_number.txt"
}
if(with_Angelsub == TRUE){
name_of_mat<-"AllinteractionWithAngelsub.mat"
}else{
name_of_mat<-"Allinteraction.mat"
}
dir<-list.dirs(recursive = F,path = "D:/allGroups/Females_Mated")
dir
dir[14]
library(openxlsx)
library(stringr)
library(dplyr)
library(reshape2)
library(igraph)
library(R.matlab)
f <- function(x) {
if(is.list(x)) lapply(x, f)
else ifelse(length(x) == 0, 0, x)
}
length_of_movie<-27000
#how many frame in a batch
number_of_frame<-1
#seq by the  number of frames
numbers<-seq(1, length_of_movie, by=number_of_frame)
with_Angelsub<-TRUE
#if i want without angelsub for calcualtin of interaction choose Allinteraction.mat
#if you do want it choose AllinteractionWithAngelsub.mat
if(length_of_movie == 54000){
name_of_interactionmat_len<-"interactionMatrix_frame_0_to_54000_gap_120_interaction_length.txt"
name_of_interactionmat_num<-"interactionMatrix_frame_0_to_54000_gap_120_interaction_number.txt"
}
if(length_of_movie == 27000){
name_of_interactionmat_len<-"interactionMatrix_frame_0_to_27000_gap_120_interaction_length.txt"
name_of_interactionmat_num<-"interactionMatrix_frame_0_to_27000_gap_120_interaction_number.txt"
}
if(with_Angelsub == TRUE){
name_of_mat<-"AllinteractionWithAngelsub.mat"
}else{
name_of_mat<-"Allinteraction.mat"
}
dir<-list.dirs(recursive = F,path = "D:/allGroups/Females_Mated")
num_of_movie=14
filepath<-paste0(dir[num_of_movie], '/',name_of_mat)
if(!(file.exists(filepath))){
stop("Allinteraction.mat does not exist!!!please creat it with MainInteractionAllAngelSub.m ")
}
mat <- (readMat(paste0(dir[num_of_movie], '/',name_of_mat)))
number_of_flys<-sqrt(length(mat[["new.interactionFrameMatrix"]]))
# read each MAT file
sub_list_mat<-matrix(mat[["new.interactionFrameMatrix"]],nrow = number_of_flys, ncol = number_of_flys)
df_mat<-as.data.frame(sub_list_mat)
for(i in 1:ncol(df_mat)){
for(j in 1:nrow(df_mat)){
if(length(unlist(df_mat[i,j])) == 0){
df_mat[i,j] <- lapply(df_mat[i,j], function(x)x[lengths(x) == 0] <- 0)
}
}
}
df_mat<-na.omit(df_mat)
#10 flys
colnames(df_mat)<-c(1:number_of_flys)
rownames(df_mat)<-c(1:number_of_flys)
all<-data.frame()
path_to_sub_Scripts<-"C:/Users/barakli8/OneDrive - Bar Ilan University/Lital/code/interactions_network/dynamic/sub_scripts"
setwd(path_to_sub_Scripts)
files.sources = list.files()
sapply(files.sources, source)
all<-all_frames_interaction_above(number_of_flys,sub_list_mat,df_mat)
#for the acasct every interaction mean 1
all<-cbind(all,1)
library(dplyr)
library(igraph)
all_changes_current_movie<-NULL
for(i in 1:(length(numbers)-1)){
current_net<-creat_network(all,i,numbers)
sub_current_net<-biggest_cc_subgraph(current_net)
if(sub_current_net[[2]] == FALSE){
# no sub cluster bigger than 3
sub_current_net<-(sub_current_net[[1]])
size_of_biggest_cc_current = 0
}else{
sub_current_net<-(sub_current_net[[1]])
size_of_biggest_cc_current= length(sub_current_net)
}
#bigeest cc show the cc if it is bigger than 3,else it is 0
tmp<-data.frame(frame = i,size_cc = size_of_biggest_cc_current)
all_changes_current_movie<-rbind(all_changes_current_movie,tmp)
print(i)
}
library(zoo)
test<-all_changes_current_movie$size_cc
library(zoo)
means <- sapply(c("right","center","left"),
function(x)zoo::rollmean(test,100,align = x, na.pad = TRUE))
ttest<-cbind(test,means)
ttest<-as.data.frame(ttest)
#combind the colom of each rollmean to remove na
no_na<-ttest %>% mutate(mycol = coalesce(right,center,left)) %>%
select(test, mycol)
View(no_na)
View(all_changes_current_movie)
ggplot(no_na$mycol) +
geom_point() +
geom_line()
library(ggplot2)
ggplot(no_na$mycol) +
geom_point() +
geom_line()
after_combined_nona<-no_na$mycol
after_combined_nona<-as.data.frame(no_na$mycol)
View(after_combined_nona)
library(ggplot2)
ggplot(after_combined_nona) +
geom_point() +
geom_line()
1:length(no_na$mycol)
after_combined_nona$frame<-1:length(no_na$mycol)
View(after_combined_nona)
colnames(after_combined_nona)<-c("value","Frame")
View(after_combined_nona)
library(ggplot2)
ggplot(after_combined_nona, aes(frame,value)) +
geom_point() +
geom_line()
View(after_combined_nona)
library(ggplot2)
ggplot(after_combined_nona, aes(Frame,value)) +
geom_point() +
geom_line()
View(no_na)
colnames(no_na)<-c("original","moving_avg")
length(no_na)
ncol(no_na)
nrow(no_na)
no_na$frame<-1:nrow(no_na)
View(no_na)
melted_no_na<- melt(data = no_na, id.vars = "frame")
View(melted_no_na)
View(melted_no_na)
library(ggplot2)
ggplot(melted_no_na, aes(frame,value,colour = variable)) +
geom_point() +
geom_line() +
facet_wrap(~variable,nrow =2)
library(zoo)
test<-all_changes_current_movie$size_cc
library(zoo)
means <- sapply(c("right","center","left"),
function(x)zoo::rollmean(test,120,align = x, na.pad = TRUE))
ttest<-cbind(test,means)
ttest<-as.data.frame(ttest)
#combind the colom of each rollmean to remove na
no_na<-ttest %>% mutate(mycol = coalesce(right,center,left)) %>%
select(test, mycol)
colnames(no_na)<-c("original","moving_avg")
no_na$frame<-1:nrow(no_na)
melted_no_na<- melt(data = no_na, id.vars = "frame")
library(ggplot2)
ggplot(melted_no_na, aes(frame,value,colour = variable)) +
geom_point() +
geom_line() +
facet_wrap(~variable,nrow =2)
library(zoo)
test<-all_changes_current_movie$size_cc
library(zoo)
means <- sapply(c("right","center","left"),
function(x)zoo::rollmean(test,1000,align = x, na.pad = TRUE))
ttest<-cbind(test,means)
ttest<-as.data.frame(ttest)
#combind the colom of each rollmean to remove na
no_na<-ttest %>% mutate(mycol = coalesce(right,center,left)) %>%
select(test, mycol)
colnames(no_na)<-c("original","moving_avg")
no_na$frame<-1:nrow(no_na)
melted_no_na<- melt(data = no_na, id.vars = "frame")
library(ggplot2)
ggplot(melted_no_na, aes(frame,value,colour = variable)) +
geom_point() +
geom_line() +
facet_wrap(~variable,nrow =2)
library(ggplot2)
moving_avg_vs_reallity_compo<-ggplot(melted_no_na, aes(frame,value,colour = variable)) +
geom_point() +
geom_line() +
facet_wrap(~variable,nrow =2)
plot(moving_avg_vs_reallity_compo)
dir
library(openxlsx)
library(stringr)
library(dplyr)
library(reshape2)
library(igraph)
library(R.matlab)
f <- function(x) {
if(is.list(x)) lapply(x, f)
else ifelse(length(x) == 0, 0, x)
}
length_of_movie<-27000
#how many frame in a batch
number_of_frame<-1
#seq by the  number of frames
numbers<-seq(1, length_of_movie, by=number_of_frame)
with_Angelsub<-TRUE
#if i want without angelsub for calcualtin of interaction choose Allinteraction.mat
#if you do want it choose AllinteractionWithAngelsub.mat
if(length_of_movie == 54000){
name_of_interactionmat_len<-"interactionMatrix_frame_0_to_54000_gap_120_interaction_length.txt"
name_of_interactionmat_num<-"interactionMatrix_frame_0_to_54000_gap_120_interaction_number.txt"
}
if(length_of_movie == 27000){
name_of_interactionmat_len<-"interactionMatrix_frame_0_to_27000_gap_120_interaction_length.txt"
name_of_interactionmat_num<-"interactionMatrix_frame_0_to_27000_gap_120_interaction_number.txt"
}
if(with_Angelsub == TRUE){
name_of_mat<-"AllinteractionWithAngelsub.mat"
}else{
name_of_mat<-"Allinteraction.mat"
}
dir<-list.dirs(recursive = F,path = "D:/allGroups/Females_Mated")
num_of_movie=5
filepath<-paste0(dir[num_of_movie], '/',name_of_mat)
if(!(file.exists(filepath))){
stop("Allinteraction.mat does not exist!!!please creat it with MainInteractionAllAngelSub.m ")
}
mat <- (readMat(paste0(dir[num_of_movie], '/',name_of_mat)))
number_of_flys<-sqrt(length(mat[["new.interactionFrameMatrix"]]))
# read each MAT file
sub_list_mat<-matrix(mat[["new.interactionFrameMatrix"]],nrow = number_of_flys, ncol = number_of_flys)
df_mat<-as.data.frame(sub_list_mat)
for(i in 1:ncol(df_mat)){
for(j in 1:nrow(df_mat)){
if(length(unlist(df_mat[i,j])) == 0){
df_mat[i,j] <- lapply(df_mat[i,j], function(x)x[lengths(x) == 0] <- 0)
}
}
}
df_mat<-na.omit(df_mat)
#10 flys
colnames(df_mat)<-c(1:number_of_flys)
rownames(df_mat)<-c(1:number_of_flys)
all<-data.frame()
path_to_sub_Scripts<-"C:/Users/barakli8/OneDrive - Bar Ilan University/Lital/code/interactions_network/dynamic/sub_scripts"
setwd(path_to_sub_Scripts)
files.sources = list.files()
sapply(files.sources, source)
all<-all_frames_interaction_above(number_of_flys,sub_list_mat,df_mat)
#for the acasct every interaction mean 1
all<-cbind(all,1)
library(dplyr)
library(igraph)
all_changes_current_movie<-NULL
for(i in 1:(length(numbers)-1)){
current_net<-creat_network(all,i,numbers)
sub_current_net<-biggest_cc_subgraph(current_net)
if(sub_current_net[[2]] == FALSE){
# no sub cluster bigger than 3
sub_current_net<-(sub_current_net[[1]])
size_of_biggest_cc_current = 0
}else{
sub_current_net<-(sub_current_net[[1]])
size_of_biggest_cc_current= length(sub_current_net)
}
#bigeest cc show the cc if it is bigger than 3,else it is 0
tmp<-data.frame(frame = i,size_cc = size_of_biggest_cc_current)
all_changes_current_movie<-rbind(all_changes_current_movie,tmp)
print(i)
}
library(zoo)
test<-all_changes_current_movie$size_cc
library(zoo)
means <- sapply(c("right","center","left"),
function(x)zoo::rollmean(test,1000,align = x, na.pad = TRUE))
ttest<-cbind(test,means)
ttest<-as.data.frame(ttest)
#combind the colom of each rollmean to remove na
no_na<-ttest %>% mutate(mycol = coalesce(right,center,left)) %>%
select(test, mycol)
colnames(no_na)<-c("original","moving_avg")
no_na$frame<-1:nrow(no_na)
melted_no_na<- melt(data = no_na, id.vars = "frame")
library(ggplot2)
moving_avg_vs_reallity_compo<-ggplot(melted_no_na, aes(frame,value,colour = variable)) +
geom_point() +
geom_line() +
facet_wrap(~variable,nrow =2)
plot(moving_avg_vs_reallity_compo)
plot(moving_avg_vs_reallity_compo)
